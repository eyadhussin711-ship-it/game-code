<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Queen Hotel</title>

<style>
*{box-sizing:border-box;font-family:Tahoma}
body{
  margin:0;min-height:100vh;color:#fff;
  background:linear-gradient(270deg,#000,#001f4d,#000);
  background-size:400% 400%;
  animation:bg 15s infinite;
}
@keyframes bg{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}
.wrap{max-width:420px;margin:auto;padding:15px}
.box{
  background:rgba(0,0,30,.8);
  padding:20px;border-radius:18px;
  box-shadow:0 0 30px #000;
}
h1{
  text-align:center;
  color:red;
  animation:glow 1.5s infinite alternate;
}
@keyframes glow{
  from{text-shadow:0 0 5px red}
  to{text-shadow:0 0 20px red}
}
input,button,select{
  width:100%;padding:12px;margin:6px 0;
  border:none;border-radius:12px;
}
button{background:#0a66ff;color:#fff;font-weight:bold}
.nav{display:flex;gap:5px;margin-bottom:10px}
.nav button{flex:1;font-size:13px}
.section{display:none}
.section.active{display:block}
.item{
  background:#0a1a3a;
  padding:12px;border-radius:14px;
  margin:8px 0;
}
.room.free{border-left:6px solid #00ff88}
.room.booked{border-left:6px solid #ff3333}

.order-card{
  background:#0f2b6b;
  border-radius:14px;
  padding:12px;
  margin:10px 0;
}
.order-actions{display:flex;gap:6px;margin-top:8px}
.order-actions button{flex:1;padding:8px}
.btn-ok{background:#00c853}
.btn-cancel{background:#ff1744}
.small{font-size:12px;opacity:.8}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginBox">
  <div class="wrap">
    <div class="box">
      <h1>QUEEN</h1>
      <input id="nameInput" placeholder="Ø§Ø³Ù…Ùƒ">
      <select id="roleSelect">
        <option value="client">Ø¹Ù…ÙŠÙ„</option>
        <option value="hotel">Ù…ÙˆØ¸Ù ÙÙ†Ø¯Ù‚</option>
        <option value="cafe">Ù…ÙˆØ¸Ù ÙƒØ§ÙÙŠÙ‡</option>
        <option value="owner">Ø£ÙˆÙ†Ø±</option>
      </select>
      <input id="codeInput" placeholder="ÙƒÙˆØ¯ (Ù„Ù„Ù…ÙˆØ¸ÙÙŠÙ†)">
      <button onclick="login()">Ø¯Ø®ÙˆÙ„</button>
    </div>
  </div>
</div>

<!-- APP -->
<div id="app" style="display:none">
  <div class="wrap">

    <div class="nav">
      <button onclick="show('rooms')">ğŸ¨</button>
      <button onclick="show('orders')">ğŸ“©</button>
      <button onclick="logout()">ğŸšª</button>
    </div>

    <!-- ROOMS -->
    <div id="rooms" class="section active">
      <h3>Ø§Ù„ØºØ±Ù</h3>
      <div id="roomsList"></div>
    </div>

    <!-- ORDERS -->
    <div id="orders" class="section">
      <h3>Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</h3>
      <div id="ordersList"></div>
    </div>

  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, onSnapshot, doc, updateDoc } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBA2YeC6Mo8CZi7Ms5Gckhm4SWPmLgFNcE",
  authDomain: "queenhotel-5703c.firebaseapp.com",
  projectId: "queenhotel-5703c",
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const OWNER="OWNER-QUEEN", HOTEL="HOTEL-QUEEN", CAFE="CAFE-QUEEN";

window.login=function(){
  const n=nameInput.value.trim();
  const r=roleSelect.value;
  const c=codeInput.value;
  if(!n)return alert("Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ");
  if(r==="owner"&&c!==OWNER)return alert("ÙƒÙˆØ¯ ØºÙ„Ø·");
  if(r==="hotel"&&c!==HOTEL)return alert("ÙƒÙˆØ¯ ØºÙ„Ø·");
  if(r==="cafe"&&c!==CAFE)return alert("ÙƒÙˆØ¯ ØºÙ„Ø·");
  localStorage.user=n;
  localStorage.role=r;
  start();
}

function start(){
  loginBox.style.display="none";
  app.style.display="block";
  loadRooms();
  loadOrders();
}

window.show=id=>{
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

function loadRooms(){
  roomsList.innerHTML="";
  for(let i=1;i<=4;i++){
    roomsList.innerHTML+=`
      <div class="item room free">
        ğŸ¨ ØºØ±ÙØ© ${i}
        <button onclick="bookRoom(${i})">Ø­Ø¬Ø²</button>
      </div>`;
  }
}

window.bookRoom=async function(room){
  if(localStorage.role!=="client")return;
  const phone=prompt("Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ");
  const days=prompt("Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…");
  if(!phone||!days)return;
  await addDoc(collection(db,"orders"),{
    room,client:localStorage.user,phone,days,
    time:new Date().toLocaleTimeString(),
    status:"pending"
  });
  alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ âœ”");
}

function loadOrders(){
  onSnapshot(collection(db,"orders"),snap=>{
    ordersList.innerHTML="";
    snap.forEach(d=>{
      const o=d.data();
      ordersList.innerHTML+=`
        <div class="order-card">
          <b>ØºØ±ÙØ© ${o.room}</b><br>
          ğŸ‘¤ ${o.client}<br>
          ğŸ“ ${o.phone}<br>
          â³ ${o.days} Ø£ÙŠØ§Ù…
          <div class="order-actions">
            <button class="btn-ok" onclick="finish('${d.id}')">ØªÙ…</button>
            <button class="btn-cancel" onclick="cancel('${d.id}')">Ø¥Ù„ØºØ§Ø¡</button>
          </div>
        </div>`;
    });
  });
}

window.finish=async id=>{
  await updateDoc(doc(db,"orders",id),{status:"done"});
  alert("ØªÙ… Ø§Ù„ØªØ£Ø¬ÙŠØ± âœ”");
}
window.cancel=async id=>{
  await updateDoc(doc(db,"orders",id),{status:"cancel"});
  alert("ØªÙ… Ø§Ù„Ø¥Ù„ØºØ§Ø¡ âŒ");
}

window.logout=()=>{
  localStorage.clear();
  location.reload();
}

if(localStorage.user)start();
</script>

</body>
</html>
