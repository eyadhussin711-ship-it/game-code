<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>UC Store Support</title>

<style>
*{box-sizing:border-box;font-family:Arial}
body{
  margin:0;
  background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
  color:#fff;
}
.hidden{display:none}

/* Login */
#login{
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}
.login-box{
  width:320px;
  background:rgba(255,255,255,.15);
  padding:25px;
  border-radius:16px;
  text-align:center;
}
.login-box input{
  width:100%;
  padding:12px;
  margin:8px 0;
  border:none;
  border-radius:10px;
}
.login-box button{
  width:100%;
  padding:12px;
  border:none;
  border-radius:20px;
  background:#00f5ff;
  font-weight:bold;
}

/* App */
#app{display:flex;height:100vh}

/* Sidebar */
.sidebar{
  width:220px;
  background:rgba(0,0,0,.45);
  padding:15px;
}
.sidebar button{
  width:100%;
  padding:12px;
  margin:8px 0;
  border:none;
  border-radius:14px;
  background:rgba(255,255,255,.15);
  color:#fff;
  cursor:pointer;
}
.sidebar button.active{
  background:#00f5ff;
  color:#000;
}

/* Main */
.main{flex:1;padding:15px}
.section{display:none}
.section.active{display:block}

/* Tickets */
.ticket{
  background:rgba(255,255,255,.12);
  padding:10px;
  border-radius:10px;
  margin:8px 0;
  cursor:pointer;
}

/* Chat */
.chat{
  background:rgba(0,0,0,.3);
  padding:10px;
  height:300px;
  overflow:auto;
  border-radius:10px;
}
.msg{
  margin:6px 0;
}
.me{color:#00f5ff}
.admin{color:#ffd166}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="login">
  <div class="login-box">
    <h3>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
    <input id="username" placeholder="Ø§Ø³Ù…Ùƒ">
    <input id="code" placeholder="ÙƒÙˆØ¯ Ø§Ù„Ø£ÙˆÙ†Ø± (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
    <button onclick="login()">Ø¯Ø®ÙˆÙ„</button>
  </div>
</div>

<!-- APP -->
<div id="app" class="hidden">
  <div class="sidebar">
    <button class="nav active" onclick="openSec('tickets',this)">ğŸ§¾ Ø§Ù„Ø´ÙƒØ§ÙˆÙŠ</button>
    <button class="nav ownerOnly hidden" onclick="openSec('admin',this)">ğŸ›  Ø¯Ø¹Ù…</button>
    <button onclick="logout()">ğŸšª Ø®Ø±ÙˆØ¬</button>
  </div>

  <div class="main">
    <h3>Ø£Ù‡Ù„Ø§Ù‹ <span id="user"></span></h3>

    <!-- USER TICKETS -->
    <div id="tickets" class="section active">
      <input id="ticketMsg" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø´ÙƒÙˆÙ‰">
      <button onclick="createTicket()">ÙØªØ­ Ø´ÙƒÙˆÙ‰</button>
      <div id="myTickets"></div>
    </div>

    <!-- ADMIN PANEL -->
    <div id="admin" class="section">
      <h4>ÙƒÙ„ Ø§Ù„Ø´ÙƒØ§ÙˆÙŠ</h4>
      <div id="allTickets"></div>
    </div>

    <!-- CHAT -->
    <div id="chatRoom" class="section">
      <h4>Ø±ÙˆÙ… Ø§Ù„Ø´ÙƒÙˆÙ‰</h4>
      <div class="chat" id="chat"></div>
      <input id="chatMsg" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©">
      <button onclick="sendMsg()">Ø¥Ø±Ø³Ø§Ù„</button>
    </div>

  </div>
</div>

<script>
let currentTicket=null;

function login(){
  let u=username.value.trim();
  if(!u)return alert("Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ");

  let role = (code.value==="OWNER-999") ? "Owner" : "Player";
  localStorage.user=u;
  localStorage.role=role;

  start();
}

function start(){
  login.style.display="none";
  app.classList.remove("hidden");
  user.innerText=localStorage.user;

  if(localStorage.role==="Owner"){
    document.querySelector(".ownerOnly").classList.remove("hidden");
  }

  loadTickets();
}

function logout(){
  localStorage.clear();
  location.reload();
}

function openSec(id,btn){
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  document.querySelectorAll(".nav").forEach(b=>b.classList.remove("active"));
  btn.classList.add("active");
}

function createTicket(){
  let msg=ticketMsg.value.trim();
  if(!msg)return;

  let tickets=JSON.parse(localStorage.tickets||"[]");
  tickets.push({
    id:Date.now(),
    user:localStorage.user,
    messages:[{from:"me",text:msg}]
  });
  localStorage.tickets=JSON.stringify(tickets);
  ticketMsg.value="";
  loadTickets();
}

function loadTickets(){
  let tickets=JSON.parse(localStorage.tickets||"[]");
  myTickets.innerHTML="";
  allTickets.innerHTML="";

  tickets.forEach(t=>{
    if(t.user===localStorage.user){
      myTickets.innerHTML+=`<div class="ticket" onclick="openChat(${t.id})">Ø´ÙƒÙˆÙ‰ #${t.id}</div>`;
    }
    if(localStorage.role==="Owner"){
      allTickets.innerHTML+=`<div class="ticket" onclick="openChat(${t.id})">${t.user} - #${t.id}</div>`;
    }
  });
}

function openChat(id){
  currentTicket=id;
  openSec('chatRoom',{classList:{add(){}}});
  renderChat();
}

function renderChat(){
  let tickets=JSON.parse(localStorage.tickets);
  let t=tickets.find(x=>x.id===currentTicket);
  chat.innerHTML="";
  t.messages.forEach(m=>{
    chat.innerHTML+=`<div class="msg ${m.from}">${m.text}</div>`;
  });
}

function sendMsg(){
  let txt=chatMsg.value.trim();
  if(!txt)return;

  let tickets=JSON.parse(localStorage.tickets);
  let t=tickets.find(x=>x.id===currentTicket);
  t.messages.push({
    from: localStorage.role==="Owner" ? "admin":"me",
    text: txt
  });
  localStorage.tickets=JSON.stringify(tickets);
  chatMsg.value="";
  renderChat();
}

window.onload=()=>localStorage.user&&start();
</script>

</body>
</html>
